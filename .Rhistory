fatevents<-setNames(aggregate(dfdam$FATALITIES~dfdam$EVTYPE,FUN = sum),c("Events","Fatalities"))
str(fatevents)
freqevents<-setNames(aggregate(year(dfdam$BGN_DATE)~dfdam$EVTYPE,FUN = length),c("Nevents","Year"))
freqevents
fattotal<-setNames(aggregate(dfdam$FATALITIES~year(dfdam$BGN_DATE),FUN = sum),c("Year","Fatalities"))
head(fattotal)
freqevents<-setNames(aggregate(year(dfdam$BGN_DATE)~dfdam$EVTYPE,FUN = length),c("Nevents","Year"))
freqevents<-dfdam%>%group_by(EVTYPE)%>%summarise(freq=n())
freqevents
freqevents<-setNames(aggregate(year(dfdam$BGN_DATE)~dfdam$EVTYPE,FUN = length),c("Nevents","Year"))
freqevents
freqevents<-setNames(aggregate(year(dfdam$BGN_DATE)~dfdam$EVTYPE,FUN = length),c("Nevents","Frequency"))
g<-ggplot(freqevents,aes(Nevents,Frequency))
g+geom_point()
g<-ggplot(freqevents,aes(Nevents,Frequency))
g+geom_point()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))
g1<-ggplot(dfdam,aes(dfdam$EVTYPE))
g+geom_histogram(binwidth=1)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))
g1<-ggplot(dfdam,aes(dfdam$EVTYPE))
g1+geom_histogram(binwidth=1)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))
g1<-ggplot(dfdam,aes(dfdam$EVTYPE))
g1+geom_bar()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))
g<-ggplot(freqevents,aes(Nevents,Frequency))
g+geom_point()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))
g1<-ggplot(dfdam,aes(dfdam$EVTYPE))
g1+geom_bar()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))
g1<-ggplot(dfdam,aes(dfdam$EVTYPE))
g1+geom_histogram(binwidth=1)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+labs(title="Total number of events from 1993 to 2011",x="Event type",y="Total number of events")
g1<-ggplot(dfdam,aes(dfdam$EVTYPE))
g1+geom_bar()+ theme(axis.text.x = element_text(angle = 90, hjust = 1))+labs(title="Total number of events from 1993 to 2011",x="Event type",y="Total number of events")
tail(dfdam$BGN_DATE)
fatevents
table(dfdam$FATALITIES,dfdam$EVTYPE)
table(dfdam$EVTYPE,dfdam$FATALITIES)
table(dfdam$EVTYPE)
fatevents<-setNames(aggregate(dfdam$FATALITIES+dfdam$INJURIES~dfdam$EVTYPE,FUN = sum),c("Type","Fatalities"))
fatevents
fatevents<-setNames(aggregate(dfdam$FATALITIES~dfdam$EVTYPE,FUN = sum),c("Type","Fatalities"))
fatevents
library(lattice)
attach(dfdam)
dotplot(EVTYPE~FATALITIES|INJURIES,
main="Dotplot Plot by Number of Gears and Cylinders",
xlab="Miles Per Gallon")
dotplot(FATALITIES~INJURIES|EVTYPE,
main="Dotplot Plot by Number of Gears and Cylinders",
xlab="Miles Per Gallon")
dotplot(EVTYPE~FATALITIES,
main="Dotplot Plot by Number of Gears and Cylinders",
xlab="Miles Per Gallon")
dotplot(EVTYPE~FATALITIES,
main="Dotplot Plot by Number of Gears and Cylinders",
xlab="Fatalities")
dotplot(EVTYPE~FATALITIES+INJURIES,
main="Dotplot Plot by Number of Gears and Cylinders",
xlab="Fatalities")
library(reshape2)
df_melted <- melt(df, id.vars=c("Treatment"))
colnames(df_melted)[2] <- "Location"
dfdam_melted <- melt(dfdam[,c("EVTYPE","FATALITIES","INJURIES")], id.vars=c("Incidents","Value"))
dfdam_melted <- melt(dfdam[,c("EVTYPE","FATALITIES","INJURIES")], id=c("EVTYPE"))
str(dfdam_melted)
g2<-ggplot(dfdam_melted,aes(x=value,y=EVTYPE,color=variable))+geom_point()
library(ggplot2)
g2<-ggplot(dfdam_melted,aes(x=value,y=EVTYPE,color=variable))+geom_point()
g2
g2+labs(x="",y="")
fatevents<-setNames(aggregate(dfdam$FATALITIES+dfdam$INJURIES~dfdam$EVTYPE,FUN = sum),c("Type","Fatalities"))
dotchart(fatevents$Fatalities, labels = row.names(Type),
cex = 2, xlab = "Total number of fatalieties and injuries")
fatevents<-setNames(aggregate(dfdam$FATALITIES+dfdam$INJURIES~dfdam$EVTYPE,FUN = sum),c("Type","Incidents"))
dotchart(fatevents$Fatalities, labels = row.names(Type),
cex = 2, xlab = "Total number of fatalieties and injuries")
fatevents<-setNames(aggregate(dfdam$FATALITIES+dfdam$INJURIES~dfdam$EVTYPE,FUN = sum),c("Type","Incidents"))
dotchart(fatevents$Incidents, labels = row.names(Type),
cex = 2, xlab = "Total number of fatalieties and injuries")
fatevents<-setNames(aggregate(dfdam$FATALITIES+dfdam$INJURIES~dfdam$EVTYPE,FUN = sum),c("Type","Incidents"))
dotchart(fatevents$Incidents, labels = row.names(fatevents$Type),
cex = 2, xlab = "Total number of fatalieties and injuries")
fatevents<-setNames(aggregate(dfdam$FATALITIES+dfdam$INJURIES~dfdam$EVTYPE,FUN = sum),c("Type","Incidents"))
fatevents
values <- data.frame(value = c("a", "a", "a", "a", "a",
"b", "b", "b",
"c", "c", "c", "c"))
nr.of.appearances <- aggregate(x = values,
by = list(unique.values = values$value),
FUN = length)
nr.of.appearances
fatevents<-setNames(aggregate(dfdam$FATALITIES+dfdam$INJURIES~dfdam$EVTYPE,FUN = sum),c("Type","Incidents"))
fatevents
fatevents<-setNames(aggregate(dfdam$FATALITIES~dfdam$EVTYPE,FUN = sum),c("Type","Fatalities"))
injevents<-setNames(aggregate(dfdam$INJURIES~dfdam$EVTYPE,FUN = sum),c("Type","Injuries"))
fatinjevents<-data.frame(fatevents$Type,fatevents$Fatalities,injevents$Injuries)
fatevents<-setNames(aggregate(dfdam$FATALITIES~dfdam$EVTYPE,FUN = sum),c("Type","Fatalities"))
injevents<-setNames(aggregate(dfdam$INJURIES~dfdam$EVTYPE,FUN = sum),c("Type","Injuries"))
fatinjevents2<-dfdam%>%group_by(EVTYPE)%>%summarise(fatalities=sum(FATALITIES),injevents=sum(INJURIES))
fatinjevents<-data.frame(fatevents$Type,fatevents$Fatalities,injevents$Injuries)
library(plyr)
fatevents<-setNames(aggregate(dfdam$FATALITIES~dfdam$EVTYPE,FUN = sum),c("Type","Fatalities"))
injevents<-setNames(aggregate(dfdam$INJURIES~dfdam$EVTYPE,FUN = sum),c("Type","Injuries"))
fatinjevents2<-dfdam%>%group_by(EVTYPE)%>%summarise(fatalities=sum(FATALITIES),injevents=sum(INJURIES))
fatinjevents<-data.frame(fatevents$Type,fatevents$Fatalities,injevents$Injuries)
library(dplyr)
fatevents<-setNames(aggregate(dfdam$FATALITIES~dfdam$EVTYPE,FUN = sum),c("Type","Fatalities"))
injevents<-setNames(aggregate(dfdam$INJURIES~dfdam$EVTYPE,FUN = sum),c("Type","Injuries"))
fatinjevents2<-dfdam%>%group_by(EVTYPE)%>%summarise(fatalities=sum(FATALITIES),injevents=sum(INJURIES))
fatinjevents<-data.frame(fatevents$Type,fatevents$Fatalities,injevents$Injuries)
fatinjevents
fatinjevents2
head(fatinjevents)
dfdam[dfdam$FATALITIES==max(dfdam$FATALITIES),]
dfdam[dfdam$INJURIES==max(dfdam$INJURIES),]
dftop<-dfdam[order(dfdam$FATALITIES,dfdam$EVTYPE),]
head(dftop)
dftop<-dfdam[order(dfdam$FATALITIES,dfdam$EVTYPE,descending),]
?order
dftop<-dfdam[order(dfdam$FATALITIES,dfdam$EVTYPE,decreasing = TRUE),]
head(dftop)
dftop<-dfdam[order(-dfdam$FATALITIES,-dfdam$INJURIES),]
head(dftop)
dftop<-dfdam[with(dfdam,order(-dfdam$FATALITIES,-dfdam$INJURIES)),]
head(dftop)
dftop<-dfdam[with(dfdam,order(-dfdam$FATALITIES,dfdam$INJURIES)),]
head(dftop)
dftop<-dfdam[with(dfdam,order(dfdam$FATALITIES,dfdam$INJURIES)),]
head(dftop)
dftop<-dfdam[with(dfdam,order(-dfdam$FATALITIES,-dfdam$INJURIES)),]
head(dftop)
dftop<-dfdam[with(dfdam,order(-dfdam$INJURIES,-dfdam$FATALITIES)),]
head(dftop)
statemax<-dfdam%>%group_by(STATE)%>%summary(freq=n())
statemax
statemax<-dfdam%>%group_by(STATE)%>%summarise(freq=n())
statemax
statemax<-dfdam%>%group_by(STATE)%>%summarise(freq=n())
statemax[max(statemax$freq),"STATE"]
max(statemax$freq)
statemax[statemax$freq==max(statemax$freq),"STATE"]
library(UsingR)
data("father.son")
x<-father.son$sheight
n<-length(x)
B<-10000
?matrix
resamples<-matrix(sample(x,n*B,replace=TRUE),B,n)
resampledMedians<-apply(resamples,1,median)
str(resamples)
dim(resamples)
sd(x)
sd(x)/Sqrt(length(x))
sd(x)/sqrt(length(x))
sd(resampledMedians)
quantile(resampledMedians,c(0.25,0.975))
library(ggplot2)
g<-ggplot(data.frame(medians=resamples),aes(x=medians))
g+geom_histogram(color="lightblue",fill="lightblue",binwidth = .05)
medians<-resamples
g<-ggplot(data.frame(medians=resamples),aes(x=medians))
g+geom_histogram(color="lightblue",fill="lightblue",binwidth = .05)
str(medians)
medians<-data.frame(medians=resamples)
str(medians)
g<-ggplot(data.frame(medians=resampledMedians),aes(x=medians))
medians<-data.frame(medians=resampledMedians)
g+geom_histogram(color="lightblue",fill="lightblue",binwidth = .05)
mns = NULL
for (i in 1 : 1000) mns = c(mns, mean(runif(40)))
hist(mns)
n<-40
nsim<-1000
lam<-0.2
meanexp<-NULL
for(i in nsim) meanexp=c(meanexp,mean(rexp(n,lam)))
hist(meanexp)
n<-40
nsim<-1000
lam<-0.2
meanexp<-NULL
for(i in 1:nsim) meanexp=c(meanexp,mean(rexp(n,lam)))
hist(meanexp)
meanexp<-apply(matrix(rexp(n,lam),nsim,n),1,mean)
hist(meanexp)
set.seed(1234)
meanexp<-apply(matrix(rexp(n,lam),nsim,n),1,mean)
hist(meanexp)
n<-40
nsim<-1000
lam<-0.2
meanexp<-NULL
for(i in 1:nsim) meanexp=c(meanexp,mean(rexp(n,lam)))
hist(meanexp)
str(meanexp)
dim(meanexp)
head(meanexp)
length(meanexp)
n<-40
nsim<-1000
lam<-0.2
meanexp<-NULL
for(i in 1:1) meanexp=c(meanexp,mean(rexp(n,lamm)))
n<-40
nsim<-1000
lam<-0.2
meanexp<-NULL
for(i in 1:1) meanexp=c(meanexp,mean(rexp(n,lam)))
meanexp
meanexp<-0
for(i in 1:1) meanexp=c(meanexp,mean(rexp(n,lam)))
meanexp
meanexp<-NA
for(i in 1:1) meanexp=c(meanexp,mean(rexp(n,lam)))
meanexp
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp)
hist(meanexp)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp)
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp)
abline(v=mean(rexp(n,lam)))
hist(runif(1000))
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp)
abline(v=mean(rexp(n,lam)))
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp)
abline(v=1/0.2)
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp)
abline(v=1/0.2,col="red")
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp)
abline(v=1/0.2,col="red")
abline(v=mean(meanexp),col="blue")
mean(meanexp)
1/0.2
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp)
abline(v=1/0.2,col="red",size=1)
abline(v=mean(meanexp),col="blue",size=1)
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp)
abline(v=1/0.2,col="red",lwd = 3)
abline(v=mean(meanexp),col="blue",lwd = 3)
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp,main="Distribution of avarages of the exponential function",xlab="Avarages of the exponential sample")
abline(v=1/0.2,col="red",lwd = 3)
abline(v=mean(meanexp),col="blue",lwd = 3)
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp,main="Distribution of avarages of exp(x\lambda)",xlab="Avarages of the exponential sample")
abline(v=1/0.2,col="red",lwd = 3)
abline(v=mean(meanexp),col="blue",lwd = 3)
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp,main="Distribution of avarages of $exp(x\lambda)$",xlab="Avarages of the exponential sample")
abline(v=1/0.2,col="red",lwd = 3)
abline(v=mean(meanexp),col="blue",lwd = 3)
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp,main="Distribution of avarages of exp(x*lambda)",xlab="Avarages of the exponential sample")
abline(v=1/0.2,col="red",lwd = 3)
abline(v=mean(meanexp),col="blue",lwd = 3)
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp,main="Distribution of avarages of random variables from the exp distribution",xlab="Avarages of the exponential sample")
abline(v=1/0.2,col="red",lwd = 3)
abline(v=mean(meanexp),col="blue",lwd = 3)
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp,main="Distribution of avarages of the exponential sample",xlab="Avarages of the exponential sample")
abline(v=1/0.2,col="red",lwd = 3)
abline(v=mean(meanexp),col="blue",lwd = 3)
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp,main="Distribution of avarages of the exp sample",xlab="Avarages of the exponential sample")
abline(v=1/0.2,col="red",lwd = 3)
abline(v=mean(meanexp),col="blue",lwd = 3)
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp,main="Simulation of the exp sample distribution",xlab="Avarages of the exponential sample")
abline(v=1/0.2,col="red",lwd = 3)
abline(v=mean(meanexp),col="blue",lwd = 3)
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp,main="Exponential sample mean distribution (simulation)",xlab="Avarages of the exponential sample")
abline(v=1/0.2,col="red",lwd = 3)
abline(v=mean(meanexp),col="blue",lwd = 3)
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp,main="Exponential sample mean distribution (simulation)",xlab="Exponential sample means",cex.main=.75)
abline(v=1/0.2,col="red",lwd = 3)
abline(v=mean(meanexp),col="blue",lwd = 3)
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp,main="Exponential sample mean distribution (simulation)",xlab="Exponential sample means",cex.main=.95)
abline(v=1/0.2,col="red",lwd = 3)
abline(v=mean(meanexp),col="blue",lwd = 3)
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp,main="Exponential sample mean distribution (simulation)",xlab="Exponential sample means",cex.main=1)
abline(v=1/0.2,col="red",lwd = 3)
abline(v=mean(meanexp),col="blue",lwd = 3)
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp,main="Exponential sample mean distribution (simulation)",xlab="Exponential sample means",cex.main=1.25)
abline(v=1/0.2,col="red",lwd = 3)
abline(v=mean(meanexp),col="blue",lwd = 3)
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp,main="Exponential sample mean distribution (simulation)",xlab="Exponential sample means",cex.main=1.15)
abline(v=1/0.2,col="red",lwd = 3)
abline(v=mean(meanexp),col="blue",lwd = 3)
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-NULL
for (i in c(.2,.5,.8,1)) meanexp[i]<-apply(matrix(rexp(n*nsim,i),nsim,n),1,mean)
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-vector(NULL)
for (i in c(.2,.5,.8,1)) meanexp[i]<-apply(matrix(rexp(n*nsim,i),nsim,n),1,mean)
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-NULL
for (i in c(.2,.5,.8,1)) meanexp<-c(meanexp,apply(matrix(rexp(n*nsim,i),nsim,n),1,mean))
str(meanexp)
df<-data.frame(x=for (i in c(.2,.5,.8,1)) { meanexp<-c(meanexp,apply(matrix(rexp(n*nsim,i),nsim,n),1,mean))},y=factor(rep(c(".2",".5",".8","1")),c(nsim,nsim,nsim,nsim)))
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-NULL
for (i in c(.2,.5,.8,1)) meanexp<-c(meanexp,apply(matrix(rexp(n*nsim,i),nsim,n),1,mean))
length(meanexp)
df<-data.frame(x=for (i in c(.2,.5,.8,1)) { meanexp<-c(meanexp,apply(matrix(rexp(n*nsim,i),nsim,n),1,mean))},y=factor(rep(c(".2",".5",".8","1"),c(nsim,nsim,nsim,nsim))))
factor(rep(c(".2",".5",".8","1"),c(nsim,nsim,nsim,nsim)))
length(factor(rep(c(".2",".5",".8","1"),c(nsim,nsim,nsim,nsim))))
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-NULL
xdat<-for (i in c(.2,.5,.8,1)) { meanexp<-c(meanexp,apply(matrix(rexp(n*nsim,i),nsim,n),1,mean))}
df<-data.frame(x=xdat,y=factor(rep(c(".2",".5",".8","1"),c(nsim,nsim,nsim,nsim))))
length(meanexp)
xdat<-for (i in c(.2,.5,.8,1)) { meanexp<-c(meanexp,apply(matrix(rexp(n*nsim,i),nsim,n),1,mean))}
length(xdat)
xdat<-for (i in c(.2,.5,.8,1)) meanexp<-c(meanexp,apply(matrix(rexp(n*nsim,i),nsim,n),1,mean))
length(xdat)
meanexp<-NULL
xdat<-for (i in c(.2,.5,.8,1)) meanexp<-c(meanexp,apply(matrix(rexp(n*nsim,i),nsim,n),1,mean))
length(xdat)
n<-40
nsim<-1000
lam<-0.2
meanexp<-NULL
xdat<-for (i in c(.2,.5,.8,1)) meanexp<-c(meanexp,apply(matrix(rexp(n*nsim,i),nsim,n),1,mean))
length(xdat)
str(xdat)
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-NULL
for (i in c(.2,.5,.8,1)) meanexp<-c(meanexp,apply(matrix(rexp(n*nsim,i),nsim,n),1,mean))
length(meanexp)
n<-40
nsim<-1000
lam<-0.2
meanexp<-NULL
for (i in c(.2,.5,.8,1)) meanexp<-c(meanexp,apply(matrix(rexp(n*nsim,i),nsim,n),1,mean))
df<-data.frame(x=meanexp,y=factor(rep(c(".2",".5",".8","1"),c(nsim,nsim,nsim,nsim))))
ggplot(dat, aes(x = x, fill = y)) + geom_density(size = 2, alpha = .2) + geom_vline(xintercept = 1, size = 2)
library(ggplot2)
ggplot(dat, aes(x = x, fill = y)) + geom_density(size = 2, alpha = .2) + geom_vline(xintercept = 1, size = 2)
ggplot(df, aes(x = x, fill = y)) + geom_density(size = 2, alpha = .2) + geom_vline(xintercept = 1, size = 2)
ggplot(df, aes(x = x, fill = y)) + geom_density(size = 1, alpha = .2)
n<-40
nsim<-1000
lam<-0.2
meanexp<-NULL
for (i in c(.1,.2,.5,.8,1)) meanexp<-c(meanexp,apply(matrix(rexp(n*nsim,i),nsim,n),1,mean))
df<-data.frame(x=meanexp,y=factor(rep(c(".1,.2",".5",".8","1"),c(nsim,nsim,nsim,nsim))))
ggplot(df, aes(x = x, fill = y)) + geom_density(size = 1, alpha = .2)
for (i in c(.1,.2,.5,.8,1)) meanexp<-c(meanexp,apply(matrix(rexp(n*nsim,i),nsim,n),1,mean))
df<-data.frame(x=meanexp,y=factor(rep(c(".1,.2",".5",".8","1"),c(nsim,nsim,nsim,nsim,nsim))))
ggplot(df, aes(x = x, fill = y)) + geom_density(size = 1, alpha = .2)
for (i in c(.1,.2,.5,.8,1)) meanexp<-c(meanexp,apply(matrix(rexp(n*nsim,i),nsim,n),1,mean))
df<-data.frame(x=meanexp,y=factor(rep(c(".1",".2",".5",".8","1"),c(nsim,nsim,nsim,nsim,nsim))))
ggplot(df, aes(x = x, fill = y)) + geom_density(size = 1, alpha = .2)
sim<-NULL
for (i in 0:4) sim<-sd(meanexp[1+1000*i:1000*(i+1)])
sim
meanexp[3000]
?split
vec<-split(meanexp, rep(1:1000, each=1000))
vec<-split(meanexp, rep(1:1000, each=5))
str(vec)
dim(vec)
head(vec)
vec<-sapply(split(meanexp, rep(1:1000, each=4)), sd)
vec<-sapply(split(meanexp, rep(1:1000, each=5)), sd)
vec
vec<-sapply(split(meanexp, ceiling(seq_along(meanexp)/1000)), sd)
vec
vec<-sapply(split(meanexp, ceiling(seq_along(meanexp)/5)), sd)
vec
vec<-sapply(split(meanexp, seq_along(meanexp)/1000), sd)
vec
vec<-sapply(split(meanexp, 1:1000), sd)
vec
sim<-c(sd(meanexp[1:1000]),sd(meanexp[1001:2000]),sd(meanexp[2001:3000]),sd(meanexp[3001:4000]),sd(meanexp[4001:5000]))
theo<-c(1/.1,1/.2,1/.5,1/.8,1)
sim
theo
1/.2
n<-40
nsim<-1000
lam<-0.2
set.seed(1234)
meanexp<-apply(matrix(rexp(n*nsim,lam),nsim,n),1,mean)
hist(meanexp,main="Exponential sample mean distribution (simulation)",xlab="Exponential sample means",cex.main=.75)
abline(v=1/0.2,col="red",lwd = 3)
abline(v=mean(meanexp),col="blue",lwd = 3)
n<-40
nsim<-1000
lam<-0.2
meanexp<-NULL
for (i in c(.1,.2,.5,.8,1)) meanexp<-c(meanexp,apply(matrix(rexp(n*nsim,i),nsim,n),1,mean))
df<-data.frame(x=meanexp,y=factor(rep(c(".1",".2",".5",".8","1"),c(nsim,nsim,nsim,nsim,nsim))))
ggplot(df, aes(x = x, fill = y)) + geom_density(size = 1, alpha = .2)
sd(meanexp[1:1000])
mean(meanexp[1:1000])
sd(meanexp[1:1000])/sqrt(40)
sd(meanexp[1:1000])/sqrt(40)
sd(meanexp[4001:5000])/sqrt(40)
1/.2
sim<-c(sd(meanexp[1:1000])/sqrt(n),sd(meanexp[1001:2000])/sqrt(n),sd(meanexp[2001:3000])/sqrt(n),sd(meanexp[3001:4000])/sqrt(n),sd(meanexp[4001:5000])/sqrt(n))
theo<-c(1/.1,1/.2,1/.5,1/.8,1)
sim
theo
